<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>捷奧不馴 Travel Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', -apple-system, sans-serif; background-color: black; color: white; margin: 0; }
        @keyframes pulse-purple {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }
        .animate-glow { animation: pulse-purple 2s infinite; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const Icon = ({ name, size = 20, className = "" }) => {
            useEffect(() => { if (window.lucide) window.lucide.createIcons(); }, [name]);
            return <i data-lucide={name} className={className} style={{ width: size, height: size }}></i>;
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('home');
            const [currentTime, setCurrentTime] = useState(new Date());
            const [isItineraryEditing, setIsItineraryEditing] = useState(false);
            const [isTransportEditing, setIsTransportEditing] = useState(false);
            const [isPackingEditing, setIsPackingEditing] = useState(false);
            const [isSouvenirEditing, setIsSouvenirEditing] = useState(false);

            // 1. 完整行程數據 (1/06 - 1/14)
            const [itinerary, setItinerary] = useState([
                { date: '2026-01-06', day: 'Day 1', events: [{ id: 1, time: '23:45', location: '臺灣桃園國際機場', note: '出發去歐洲！' }] },
                { date: '2026-01-07', day: 'Day 2', events: [
                    { id: 2, time: '07:40', location: '布拉格機場', note: '抵達' },
                    { id: 3, time: '09:49', location: 'Grandior Hotel Prague', note: '放行李' },
                    { id: 4, time: '11:36', location: '老城廣場', note: '' },
                    { id: 5, time: '15:01', location: '布拉格天文鐘', note: '' },
                    { id: 6, time: '18:09', location: 'Bredovský Dvůr', note: '' }
                ]},
                { date: '2026-01-08', day: 'Day 3', events: [
                    { id: 7, time: '08:59', location: '布拉格城堡', note: '' },
                    { id: 8, time: '14:18', location: '查理大橋', note: '' }
                ]},
                { date: '2026-01-10', day: 'Day 5', events: [
                    { id: 9, time: '06:37', location: '布拉格火車總站', note: 'RJ53' },
                    { id: 10, time: '10:49', location: '維也納中央車站', note: '' }
                ]},
                { date: '2026-01-11', day: 'Day 6', events: [
                    { id: 11, time: '05:57', location: '維也納中央車站', note: '前往哈爾施塔特' },
                    { id: 12, time: '09:47', location: 'Hallstatt', note: '抵達小鎮' }
                ]},
                { date: '2026-01-14', day: 'Day 9', events: [{ id: 13, time: '05:30', location: '臺灣桃園國際機場', note: '家到了！' }] }
            ]);

            // 2. 交通數據
            const [transportation, setTransportation] = useState([
                { id: 1, date: '1/10', from: 'PRG', fromFull: '布拉格', to: 'VIE', toFull: '維也納', trainNo: 'RJ53', platform: '--', carNo: '368', seatNo: '32, 38' },
                { id: 2, date: '1/11', from: 'VIE', fromFull: '維也納', to: 'HAL', toFull: '哈爾施塔特', trainNo: 'IC540', platform: '--', carNo: '4', seatNo: '131, 135' }
            ]);

            const [packingList, setPackingList] = useState([{ id: 1, item: '護照/電子機票', checked: true }, { id: 2, item: '歐洲轉接頭', checked: false }]);
            const [souvenirs, setSouvenirs] = useState([{ id: 1, person: '爸媽', gift: '莫札特巧克力', bought: false }]);

            // 時區邏輯
            useEffect(() => {
                const timer = setInterval(() => setCurrentTime(new Date()), 1000);
                return () => clearInterval(timer);
            }, []);

            const pragueTime = useMemo(() => {
                const offset = 7;
                return new Date(currentTime.getTime() - (offset * 60 * 60 * 1000));
            }, [currentTime]);

            const tripStatus = useMemo(() => {
                const nowStr = pragueTime.getHours().toString().padStart(2, '0') + ":" + pragueTime.getMinutes().toString().padStart(2, '0');
                const today = pragueTime.toISOString().split('T')[0];
                const dayPlan = itinerary.find(d => d.date === today);
                if (!dayPlan) return today < itinerary[0].date ? "旅程即將開始..." : "旅程已結束";
                const past = dayPlan.events.filter(e => e.time <= nowStr).sort((a,b) => b.time.localeCompare(a.time));
                return past.length > 0 ? `${nowStr} ${past[0].location}` : "今日旅程尚未開始";
            }, [pragueTime, itinerary]);

            // 修改功能
            const updatePacking = (id, text) => setPackingList(packingList.map(p => p.id === id ? {...p, item: text} : p));
            const updateSouvenir = (id, field, text) => setSouvenirs(souvenirs.map(s => s.id === id ? {...s, [field]: text} : s));

            return (
                <div className="max-w-md mx-auto min-h-screen bg-black pb-32 overflow-x-hidden">
                    {activeTab === 'home' && (
                        <div className="p-6 space-y-8">
                            <header className="flex justify-between items-center py-4">
                                <h1 className="text-3xl font-black italic tracking-tighter">TRAV <span className="text-purple-600">PRO</span></h1>
                                <Icon name="globe" className="text-purple-500" />
                            </header>
                            <div className="grid grid-cols-2 gap-4">
                                <div className="bg-gray-900 p-5 rounded-[2rem] border border-gray-800">
                                    <p className="text-[10px] text-gray-500 font-bold uppercase">台北 (TW)</p>
                                    <h3 className="text-2xl font-black">{currentTime.getHours().toString().padStart(2, '0')}:{currentTime.getMinutes().toString().padStart(2, '0')}</h3>
                                </div>
                                <div className="bg-purple-900/20 p-5 rounded-[2rem] border border-purple-500/40 relative">
                                    <div className="absolute top-3 right-4 h-2 w-2 animate-ping bg-purple-500 rounded-full"></div>
                                    <p className="text-[10px] text-purple-400 font-bold uppercase">捷奧 (EU)</p>
                                    <h3 className="text-2xl font-black">{pragueTime.getHours().toString().padStart(2, '0')}:{pragueTime.getMinutes().toString().padStart(2, '0')}</h3>
                                </div>
                            </div>
                            <div className="bg-gradient-to-br from-purple-900/40 to-black p-8 rounded-[2.5rem] border border-purple-500/20 shadow-2xl">
                                <p className="text-[10px] text-purple-400 font-bold mb-2 uppercase tracking-widest">Live Now</p>
                                <h2 className="text-2xl font-bold leading-tight">{tripStatus}</h2>
                            </div>
                            <div className="grid grid-cols-2 gap-4">
                                <button onClick={() => setActiveTab('itinerary')} className="bg-gray-900 h-32 rounded-[2rem] flex flex-col items-center justify-center gap-2 border border-gray-800"><Icon name="calendar" className="text-purple-500" /><span className="text-xs font-bold uppercase">詳細行程</span></button>
                                <button onClick={() => setActiveTab('transport')} className="bg-gray-900 h-32 rounded-[2rem] flex flex-col items-center justify-center gap-2 border border-gray-800"><Icon name="navigation" className="text-blue-500" /><span className="text-xs font-bold uppercase">交通票券</span></button>
                                <button onClick={() => setActiveTab('packing')} className="bg-gray-900 h-32 rounded-[2rem] flex flex-col items-center justify-center gap-2 border border-gray-800"><Icon name="package" className="text-pink-500" /><span className="text-xs font-bold uppercase">行李清單</span></button>
                                <button onClick={() => setActiveTab('souvenir')} className="bg-gray-900 h-32 rounded-[2rem] flex flex-col items-center justify-center gap-2 border border-gray-800"><Icon name="gift" className="text-orange-500" /><span className="text-xs font-bold uppercase">伴手禮</span></button>
                            </div>
                        </div>
                    )}

                    {activeTab === 'itinerary' && (
                        <div className="p-6 space-y-8">
                            <div className="flex justify-between items-center sticky top-0 bg-black/90 py-4 z-20">
                                <h2 className="text-2xl font-black">行程表</h2>
                                <button onClick={() => setIsItineraryEditing(!isItineraryEditing)} className="text-xs font-bold text-purple-400 bg-gray-800 px-4 py-2 rounded-full">{isItineraryEditing ? '保存' : '編輯'}</button>
                            </div>
                            {itinerary.map((day, dIdx) => (
                                <div key={dIdx} className="space-y-4">
                                    <div className="flex items-center gap-3">
                                        <span className="bg-purple-900 px-3 py-1 rounded-full text-[10px] font-black">{day.day}</span>
                                        <span className="text-gray-500 text-xs font-mono">{day.date}</span>
                                    </div>
                                    <div className="ml-2 border-l border-gray-800 pl-6 space-y-6">
                                        {day.events.map((event, eIdx) => {
                                            const isNow = tripStatus.includes(event.location);
                                            return (
                                                <div key={event.id} className={`p-5 rounded-[2rem] border ${isNow ? 'bg-purple-900/10 border-purple-500' : 'bg-gray-900/40 border-gray-800'}`}>
                                                    {isNow && <div className="absolute -left-[30px] h-3 w-3 bg-purple-500 rounded-full animate-glow"></div>}
                                                    {isItineraryEditing ? (
                                                        <input value={event.location} onChange={(e) => {
                                                            const n = [...itinerary]; n[dIdx].events[eIdx].location = e.target.value; setItinerary(n);
                                                        }} className="bg-black text-white p-1 rounded w-full border border-gray-700"/>
                                                    ) : (
                                                        <>
                                                            <div className="text-purple-500 font-mono text-[10px] font-black">{event.time}</div>
                                                            <h4 className="font-bold">{event.location}</h4>
                                                            {event.note && <p className="text-gray-500 text-[10px] mt-1">{event.note}</p>}
                                                        </>
                                                    )}
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}

                    {activeTab === 'transport' && (
                        <div className="p-6 space-y-6">
                            <h2 className="text-2xl font-black">交通指南</h2>
                            {transportation.map(t => (
                                <div key={t.id} className="bg-white rounded-[2.5rem] overflow-hidden text-black mb-6 shadow-2xl">
                                    <div className="bg-purple-600 p-6 text-white text-center">
                                        <div className="flex justify-between items-center mb-6">
                                            <span className="text-[9px] font-black px-2 py-1 bg-white/20 rounded uppercase">{t.date}</span>
                                            <Icon name="train" />
                                        </div>
                                        <div className="flex items-center justify-between">
                                            <h3 className="text-2xl font-black w-24">{t.from}</h3>
                                            <div className="flex-1 border-t border-dashed border-white/50 relative mx-2">
                                                <div className="absolute -top-3 left-1/2 -translate-x-1/2 bg-purple-600 px-3 py-1 border border-white/20 rounded-full text-[10px] font-black">{t.trainNo}</div>
                                            </div>
                                            <h3 className="text-2xl font-black w-24">{t.to}</h3>
                                        </div>
                                    </div>
                                    <div className="bg-white p-6 grid grid-cols-3 text-center border-t border-gray-100 relative">
                                        <div className="absolute -top-3 -left-3 w-6 h-6 bg-black rounded-full"></div>
                                        <div className="absolute -top-3 -right-3 w-6 h-6 bg-black rounded-full"></div>
                                        <div><p className="text-[9px] text-gray-400 font-black mb-1">PLAT</p><p className="font-black text-xl">{t.platform}</p></div>
                                        <div><p className="text-[9px] text-gray-400 font-black mb-1">CAR</p><p className="font-black text-xl">{t.carNo}</p></div>
                                        <div><p className="text-[9px] text-gray-400 font-black mb-1">SEAT</p><p className="font-black text-xl">{t.seatNo}</p></div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}

                    {activeTab === 'packing' && (
                        <div className="p-6 space-y-6">
                            <div className="flex justify-between items-center">
                                <h2 className="text-2xl font-black">行李清單</h2>
                                <button onClick={() => setIsPackingEditing(!isPackingEditing)} className="text-xs font-bold text-purple-400 bg-gray-800 px-4 py-2 rounded-full">{isPackingEditing ? '保存' : '編輯'}</button>
                            </div>
                            <div className="space-y-3">
                                {packingList.map(p => (
                                    <div key={p.id} className="flex items-center gap-4 p-5 bg-gray-900 rounded-[2rem] border border-gray-800">
                                        <div onClick={() => setPackingList(packingList.map(x=>x.id===p.id?{...x, checked:!x.checked}:x))} className={`p-1 rounded-full border-2 ${p.checked ? 'bg-purple-500 border-purple-500' : 'border-gray-700'}`}><Icon name="check" size={14} className={p.checked ? 'text-white' : 'text-transparent'} /></div>
                                        {isPackingEditing ? <input value={p.item} onChange={(e)=>updatePacking(p.id, e.target.value)} className="bg-black border border-gray-700 rounded-lg p-1 flex-1 text-sm"/> : <span className={`font-bold ${p.checked ? 'text-gray-600 line-through' : 'text-white'}`}>{p.item}</span>}
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}

                    {activeTab === 'souvenir' && (
                        <div className="p-6 space-y-6">
                            <div className="flex justify-between items-center">
                                <h2 className="text-2xl font-black">伴手禮</h2>
                                <button onClick={() => setIsSouvenirEditing(!isSouvenirEditing)} className="text-xs font-bold text-purple-400 bg-gray-800 px-4 py-2 rounded-full">{isSouvenirEditing ? '保存' : '編輯'}</button>
                            </div>
                            <div className="grid gap-4">
                                {souvenirs.map(s => (
                                    <div key={s.id} className="p-6 bg-gray-900 border border-gray-800 rounded-[2.5rem] flex items-center justify-between shadow-lg">
                                        <div className="flex items-center gap-5 flex-1">
                                            <div onClick={() => setSouvenirs(souvenirs.map(i=>i.id===s.id?{...i, bought:!i.bought}:i))} className={`p-4 rounded-2xl ${s.bought ? 'bg-purple-600 text-white' : 'bg-gray-800 text-gray-500'}`}><Icon name="gift" /></div>
                                            <div className="flex-1">
                                                {isSouvenirEditing ? (
                                                    <div className="space-y-2">
                                                        <input value={s.person} onChange={(e)=>updateSouvenir(s.id, 'person', e.target.value)} className="bg-black border border-gray-700 rounded p-1 w-full text-xs text-purple-400"/>
                                                        <input value={s.gift} onChange={(e)=>updateSouvenir(s.id, 'gift', e.target.value)} className="bg-black border border-gray-700 rounded p-1 w-full text-sm font-bold"/>
                                                    </div>
                                                ) : (
                                                    <>
                                                        <p className="text-purple-500 text-[10px] font-black uppercase tracking-widest">{s.person}</p>
                                                        <h4 className={`text-lg font-bold ${s.bought ? 'text-gray-600 line-through' : 'text-white'}`}>{s.gift}</h4>
                                                    </>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}

                    {/* 導航 */}
                    <nav className="fixed bottom-6 left-1/2 -translate-x-1/2 w-[92%] bg-black/80 backdrop-blur-3xl border border-white/10 rounded-[2.5rem] px-4 py-2 z-50 flex justify-between items-center shadow-2xl">
                        <NavBtn id="home" icon="map-pin" active={activeTab === 'home'} onClick={setActiveTab} />
                        <NavBtn id="itinerary" icon="calendar" active={activeTab === 'itinerary'} onClick={setActiveTab} />
                        <div className="h-8 w-[1px] bg-white/10 mx-1"></div>
                        <NavBtn id="transport" icon="navigation" active={activeTab === 'transport'} onClick={setActiveTab} />
                        <NavBtn id="packing" icon="package" active={activeTab === 'packing'} onClick={setActiveTab} />
                        <NavBtn id="souvenir" icon="gift" active={activeTab === 'souvenir'} onClick={setActiveTab} />
                    </nav>
                </div>
            );
        };

        const NavBtn = ({ id, icon, active, onClick }) => (
            <button onClick={() => onClick(id)} className={`p-4 transition-all duration-300 rounded-full ${active ? 'bg-purple-600 text-white shadow-lg shadow-purple-500/50' : 'text-gray-500'}`}>
                <Icon name={id === 'transport' ? 'navigation' : icon} size={18} />
            </button>
        );

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>